<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
        <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
        <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script src="http://dev.ehouais.net/webviews/webviews.js"></script>
        <style>
            body {
                overflow: hidden;
            }
            .tab-pane >iframe {
                border: none;
                width: 100%;
                height: 100%;
            }
            .nav-pills {
                padding: 4px;
            }
            .nav-pills li a {
                padding: 2px 4px;
                margin-left: 2px;
            }
        </style>
        <script>
            var Tabs = Webviews.data();

            $(function() {
                var $tlst = $('body >.nav-pills'),
                    $ttpl = $('li', $tlst).detach().removeClass('template'),
                    $tplst = $('body >.tab-content'),
                    $tptpl = $('>.tab-pane', $tplst).detach().removeClass('template');

                Tabs.bind(function(data) {
                    var tabs = JSON.parse(data);

                    $tlst.empty();
                    $tplst.empty();
                    tabs.forEach(function(tab, i) {
                        var id = 'tabpane_'+i;

                        $ttpl.clone().appendTo($tlst).find('a').attr('href', '#'+id).text(tab.label).on('shown.bs.tab', function() {
                            var $iframe = $('#'+id).find('>iframe');
                            if (!$iframe.attr('src')) $iframe.attr('src', tab.uri);
                        });
                        $tptpl.clone().appendTo($tplst).attr('id', id);
                    });

                    (window.onresize = function() {
                        $('iframe').height($(window).height()-$tlst.outerHeight());
                    })();
                    $('>li a', $tlst).eq(0).tab('show');
                });
            });
        </script>
    </head>
    <body>
        <ul class="nav nav-pills" role="tablist">
            <li role="presentation"><a aria-controls="home" role="tab" data-toggle="tab"></a></li>
        </ul>
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane">
                <iframe/>
            </div>
        </div>
    </body>
</html>
